<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Orçamento Oficina Marinho</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js" integrity="sha512-GsLlZN/3F2ErC5ifS5QtgpiJtWd43JWSuIgh7mbzZ8zBps+dvLusV+eNQATqgA/HdeKFVgA5v3S/cIrLF7QnIg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</head>
<body>
    <div class="container my-5">
        <div class="text-center">
            <img src="img/loo.jpg" alt="Logo da Oficina" id="logo" style="max-width: 150px;">
            <h1 class="my-3">Orçamento Oficina Marinho</h1>
        </div>
        <form id="invoice">
            <div class="mb-3">
                <label for="carModel" class="form-label">Modelo do Carro</label>
                <input type="text" class="form-control" id="carModel" placeholder="Digite o modelo">
            </div>
            <div class="mb-3">
                <label for="carPlate" class="form-label">Placa</label>
                <input type="text" class="form-control" id="carPlate" placeholder="Digite a placa">
            </div>
            <div class="mb-3">
                <label for="carColor" class="form-label">Cor</label>
                <input type="text" class="form-control" id="carColor" placeholder="Digite a cor">
            </div>
            <div class="mb-3">
                <label for="carYear" class="form-label">Ano</label>
                <input type="number" class="form-control" id="carYear" placeholder="Digite o ano">
            </div>
            <div class="mb-3">
                <label for="services" class="form-label">Serviços</label>
                <div>
                    <input type="checkbox" id="polimento" value="120">
                    <label for="polimento">Polimento (R$120)</label>
                </div>
                <div>
                    <input type="checkbox" id="pintura" value="250">
                    <label for="pintura">Pintura (peça: R$250)</label>
                </div>
                <div>
                    <input type="checkbox" id="funilaria" value="150">
                    <label for="funilaria">Funilaria (peça: R$150)</label>
                </div>
            </div>
            <div class="mb-3">
                <label for="piecesAffected" class="form-label">Quantidade de peças afetadas</label>
                <input type="number" class="form-control" id="piecesAffected" placeholder="Digite a quantidade">
            </div>
            <div class="mb-3">
                <label for="piecesNames" class="form-label">Nome das peças</label>
                <textarea class="form-control" id="piecesNames" rows="2"></textarea>
            </div>
            <div class="mb-3">
                <label for="repairCost" class="form-label">Valor dos reparos</label>
                <input type="number" class="form-control" id="repairCost" placeholder="Digite o valor total dos reparos">
            </div>
            <div class="mb-3">
                <label for="observation" class="form-label">Observações</label>
                <textarea class="form-control" id="observation" rows="3"></textarea>
            </div>
            <div class="mb-3">
                <label for="entryDate" class="form-label">Data de entrada</label>
                <input type="date" class="form-control" id="entryDate">
            </div>
            <div class="mb-3">
                <label for="deliveryDate" class="form-label">Data de entrega prevista</label>
                <input type="date" class="form-control" id="deliveryDate">
            </div>
            <div class="text-center">
                <button type="button" class="btn btn-primary" id="download-button">Gerar PDF</button>
            </div>
        </form>
    </div>

    <script>
        document.getElementById('deliveryDate').addEventListener('change', () => {
            const entryDate = new Date(document.getElementById('entryDate').value);
            const deliveryDate = new Date(document.getElementById('deliveryDate').value);

            if (entryDate && deliveryDate) {
                const diffTime = Math.abs(deliveryDate - entryDate);
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));

                document.getElementById('estimatedTime').value = `${diffDays} dia(s)`;
            }
        });

        document.getElementById('download-button').addEventListener('click', () => {
            const element = document.getElementById('invoice');
            const options = {
                margin: 10,
                filename: 'orcamento-oficina.pdf',
                html2canvas: { scale: 2, scrollY: 0 },
                jsPDF: { unit: 'mm', format: 'a4' },
                pagebreak: { mode: ['avoid-all', 'css', 'legacy'] }
            };

            html2pdf().set(options).from(element).save();
        });
    </script>
</body>
</html>
